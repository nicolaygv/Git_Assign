var widget=function(){"use strict";var le=Object.defineProperty,ge=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var V=(u,l,g)=>l in u?le(u,l,{enumerable:!0,configurable:!0,writable:!0,value:g}):u[l]=g,h=(u,l)=>{for(var g in l||(l={}))fe.call(l,g)&&V(u,g,l[g]);if(k)for(var g of k(l))pe.call(l,g)&&V(u,g,l[g]);return u},j=(u,l)=>ge(u,ue(l));const u=()=>{const n=document.querySelector("[data-gyg-partner-id]");if(n)return n.getAttribute("data-gyg-partner-id")},l=()=>{let n="";const t=document.querySelector("[data-gyg-widget]");return t&&(n=t.dataset.gygPartnerId,n||([,,,n]=document.querySelector("[data-gyg-widget]").dataset.gygHref.split("/"))),n},g=()=>{let n="";const t=document.querySelector('script[src*="getyourguide.com/v2/core"]');if(t){const e=t.attributes.onload.value.split("'"),r=e.findIndex(o=>o==="partnerId");n=e[r+2]}return n},X=()=>{const n=u();if(n)return n;const t=l();if(t)return t;const e=g();return e||null},K=(n,t=null)=>{const e=document.getElementsByTagName("head")[0],r=document.createElement("script");r.async=!0,r.src=n,t&&(r.setAttribute("data-gyg-partner-id",t),r.setAttribute("data-gyg-script-origin","widget")),e==null||e.appendChild(r)},J=n=>{const t="https://widget.getyourguide.com/dist/pa.umd.production.min.js";!document.querySelector(`script[src*="${t}"]`)&&!["getyourguide","gygdev.gygtest","localhost","127.0.0.1","wp-admin"].some(o=>n.location.hostname.includes(o))&&K(t,n.GYG.partnerHash)},z=(n,t)=>{if(!n||!t)return;const e=n.parentElement;e.style.height=`${t}px`},W="data-gyg-widget-rendered",Z=n=>{n.hasAttribute(W)||n.setAttribute(W,`${Date.now()}`)},Q=n=>{window.addEventListener("message",t=>n(t),!1)},tt=n=>{const{height:t=0,widgetContext:e=null,channel:r=null,name:o=null}=n.data;if(r==="GYG"&&o){const a=document.querySelector(`iframe[name="${o}"]`);if(!a)return;if(z(a,t),Z(a),e&&Object.prototype.hasOwnProperty.call(e,"hasWidgetContext")&&!e.hasWidgetContext){const i=a.parentElement,c=new URL(a.src).searchParams.get("q");i.sendContext(h({q:c},e))}}};var b,et=new Uint8Array(16);function nt(){if(!b&&(b=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!b))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(et)}var rt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function N(n){return typeof n=="string"&&rt.test(n)}for(var d=[],R=0;R<256;++R)d.push((R+256).toString(16).substr(1));function _(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(d[n[t+0]]+d[n[t+1]]+d[n[t+2]]+d[n[t+3]]+"-"+d[n[t+4]]+d[n[t+5]]+"-"+d[n[t+6]]+d[n[t+7]]+"-"+d[n[t+8]]+d[n[t+9]]+"-"+d[n[t+10]]+d[n[t+11]]+d[n[t+12]]+d[n[t+13]]+d[n[t+14]]+d[n[t+15]]).toLowerCase();if(!N(e))throw TypeError("Stringified UUID is invalid");return e}function ot(n){if(!N(n))throw TypeError("Invalid UUID");var t,e=new Uint8Array(16);return e[0]=(t=parseInt(n.slice(0,8),16))>>>24,e[1]=t>>>16&255,e[2]=t>>>8&255,e[3]=t&255,e[4]=(t=parseInt(n.slice(9,13),16))>>>8,e[5]=t&255,e[6]=(t=parseInt(n.slice(14,18),16))>>>8,e[7]=t&255,e[8]=(t=parseInt(n.slice(19,23),16))>>>8,e[9]=t&255,e[10]=(t=parseInt(n.slice(24,36),16))/1099511627776&255,e[11]=t/4294967296&255,e[12]=t>>>24&255,e[13]=t>>>16&255,e[14]=t>>>8&255,e[15]=t&255,e}function at(n){n=unescape(encodeURIComponent(n));for(var t=[],e=0;e<n.length;++e)t.push(n.charCodeAt(e));return t}var it="6ba7b810-9dad-11d1-80b4-00c04fd430c8",st="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ct(n,t,e){function r(o,a,i,c){if(typeof o=="string"&&(o=at(o)),typeof a=="string"&&(a=ot(a)),a.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+o.length);if(s.set(a),s.set(o,a.length),s=e(s),s[6]=s[6]&15|t,s[8]=s[8]&63|128,i){c=c||0;for(var f=0;f<16;++f)i[c+f]=s[f];return i}return _(s)}try{r.name=n}catch{}return r.DNS=it,r.URL=st,r}function L(n,t,e){n=n||{};var r=n.random||(n.rng||nt)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){e=e||0;for(var o=0;o<16;++o)t[e+o]=r[o];return t}return _(r)}function dt(n,t,e,r){switch(n){case 0:return t&e^~t&r;case 1:return t^e^r;case 2:return t&e^t&r^e&r;case 3:return t^e^r}}function P(n,t){return n<<t|n>>>32-t}function lt(n){var t=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var o=0;o<r.length;++o)n.push(r.charCodeAt(o))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var a=n.length/4+2,i=Math.ceil(a/16),c=new Array(i),s=0;s<i;++s){for(var f=new Uint32Array(16),p=0;p<16;++p)f[p]=n[s*64+p*4]<<24|n[s*64+p*4+1]<<16|n[s*64+p*4+2]<<8|n[s*64+p*4+3];c[s]=f}c[i-1][14]=(n.length-1)*8/Math.pow(2,32),c[i-1][14]=Math.floor(c[i-1][14]),c[i-1][15]=(n.length-1)*8&4294967295;for(var x=0;x<i;++x){for(var m=new Uint32Array(80),w=0;w<16;++w)m[w]=c[x][w];for(var y=16;y<80;++y)m[y]=P(m[y-3]^m[y-8]^m[y-14]^m[y-16],1);for(var E=e[0],I=e[1],T=e[2],S=e[3],U=e[4],G=0;G<80;++G){var F=Math.floor(G/20),de=P(E,5)+dt(F,I,T,S)+U+t[F]+m[G]>>>0;U=S,S=T,T=P(I,30)>>>0,I=E,E=de}e[0]=e[0]+E>>>0,e[1]=e[1]+I>>>0,e[2]=e[2]+T>>>0,e[3]=e[3]+S>>>0,e[4]=e[4]+U>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var gt=ct("v5",80,lt),ut=gt;const ft="https://widget.getyourguide.com",v="https://widget.getyourguide.com",pt=`${v}/default/activities.frame`,ht=`${v}/default/activities-auto.frame`,mt=`${ft}/widget-context`,yt=`${v}/auto-widget-context`,wt=`${v}/_gnikcart`,M=n=>(Object.prototype.hasOwnProperty.call(n,"GYG")||(n.GYG=n.GYG||{}),n.GYG.visitorIdPromise||(n.GYG.visitorIdPromise=fetch(wt,{credentials:"include"}).then(t=>t.json()).catch(()=>{const t=L().replace(/-/g,"").toUpperCase().substring(0,32);n.GYG.visitorIdPromise=Promise.resolve({visitor_id:t})})),n.GYG.visitorIdPromise),At=()=>{let n=!0;const t=document.querySelector("[data-gyg-load-ia]");return t&&(n=t.dataset.gygLoadIa!=="0"),n};class D{constructor(){this.createdAttribute="data-gyg-widget-created"}scrape(t){const e=Array.from(t.querySelectorAll("[data-gyg-widget]"));return e==null?void 0:e.filter(r=>!r.getAttribute(this.createdAttribute))}markElement(t){t.setAttribute(this.createdAttribute,Date.now().toString())}refreshWidgets(t){return Array.from(t.querySelectorAll(`[${this.createdAttribute}]`)).forEach(r=>{const o=r.querySelector("iframe");r.removeChild(o),r.removeAttribute(this.createdAttribute)})}async build({el:t,attributes:e}){const{visitor_id:r}=await window.GYG.visitorIdPromise,o=this.buildUrl(e,r),a=this.createIframe(o);t.appendChild(a)}buildUrl(t,e){let r=t.href;r.includes("/activites.frame")&&(r=r.replace("/activites.frame","/activities.frame")),delete t.href;const o=Object.keys(t).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`).join("&"),a=encodeURIComponent(window.location.href);return`${r}?${o}&website=${a}&visitor_id=${e}`}createIframe(t){const e=document.createElement("iframe"),r=~t.indexOf("http")?t:`https:${t}`;return e.setAttribute("src",r),e.setAttribute("name",`GYG-${L()}`),e.setAttribute("frameborder","0"),e.setAttribute("scrolling","no"),e.setAttribute("title","GetYourGuide Widget"),e.style.border="none",e.style.position="relative",e.style.visibility="visible",e.style.display="block",e.style.margin="0",e.style.padding="0",e.style.width="100%",e.style.height="100%",e}}const xt=(n,...t)=>{window.GYG.debug&&console.info(`%c[CL][${n}]`,"color: aqua; font-weight: bold;",...t)},bt=["H2","H3","H4"],vt=20,Ct=1e3,Et=500,It=2e3,Tt=["http","img","function","typeof","ajax","javascript","document.","html","px;","color:","div-","css","display:","window.","visibility:"],Y=n=>bt.includes(n),H=n=>{let t="";if(n.tagName==="IMG"){const r=n.getAttribute("ALT");r&&(t+=r+" ")}for(const r of n.getElementsByTagName("IMG")){const o=r.getAttribute("ALT");o&&(t+=o+" ")}return t},O=n=>{let t="";return n&&(B(n)||(t=n)),t},St=(n,t,e)=>t.tagName==="BODY"||e===vt||!A(n),A=n=>{const t=n.content,e=n.hasAlreadyPassedFirstHeader;return!t||t.length<Et&&e||t.length<Ct&&!e},B=n=>Tt.some(t=>n.includes(t)),C=n=>n?n.replace(/(<([^>]+)>)/gi,"").replace(/(?:https?|ftp):\/\/[\n\S]+/g,"").replace(/(\r\n|\n|\r)/gm,"").replace(/([\u00a0\t])/g," ").replace(/ +/g," ").trim().slice(0,It):null,Gt="5742218a-b6de-4ca2-8e9f-31b9c223125e";async function Rt(n){return ut(n,Gt)}function Pt(n){var e,r,o,a;const t={p:(e=n.paragraph)!=null?e:"",h:(r=n.sectionHeading)!=null?r:"",m:(o=n.metaDescription)!=null?o:"",t:(a=n.metaTitle)!=null?a:""};return Rt(JSON.stringify(t))}function Dt({target:n}){return new Ot({target:n})}function Ht({target:n}){return new Ut({target:n})}class q{constructor({target:t}){this.target=t,this.sentPayload=!1,this.payload={language:this.getLanguage,metaTitle:this.getMetaTitle,metaDescription:this.getMetaDescription,sectionHeading:this.getPreviousHeaderContent,paragraph:this.scrapeBlogPostContent,url:window.location.href},xt("PageContext",this.payload),this.target.sendContext=this.sendContext.bind(this)}async getSha(){return Pt(this.payload)}get getLanguage(){return document.documentElement.lang||null}get getMetaTitle(){return C(document.title)}get getMetaDescription(){const t=document.querySelector("meta[name=description]");return t&&t.content?C(t.content):null}get getPreviousHeaderContent(){let t=null,e=this.target.previousElementSibling;for(;e;)Y(e.tagName)?(t=e.textContent,e=null):e=e.previousElementSibling;return C(t)}get scrapeBlogPostContent(){const t=this.scrapeUpSideContentInsideWidgetContext();return A(t)&&this.scrapeDownSideContentInsideWidgetContext(t),A(t)&&this.scrapeUpSideContentOutsideWidgetContext(t),C(t.content)}scrapeUpSideContentInsideWidgetContext(){const t=this.target.textContent,e=t===null?"":t;let r=B(e)?"":e,o=this.target.previousElementSibling,a=!1;for(;o;){const i=Y(o.tagName);if(o.tagName==="BODY"||!A({hasAlreadyPassedFirstHeader:a||i,content:r})){o=null;break}else!a&&i?a=!0:(r=H(o)+" "+r,r=O(o.textContent)+" "+r);o=o.previousElementSibling}return{content:r,hasAlreadyPassedFirstHeader:a}}scrapeDownSideContentInsideWidgetContext(t){let e=this.target.nextElementSibling;for(;e;)if(!A(t))e=null;else{const r=H(e);t.content=t.content+" "+r;const o=O(e.textContent);t.content=t.content+" "+o,e=e.nextElementSibling}}scrapeUpSideContentOutsideWidgetContext(t){let e=this.target.parentElement,r=0;for(;e&&!St(t,e,r);){let o=e.previousElementSibling;for(;o;){const a=O(o.textContent);t.content=a+" "+t.content;const i=H(o);t.content=i+" "+t.content,o=o.previousElementSibling}e=e.parentElement,++r}}}class Ot extends q{sendContext(t){if(!t.q)return;const e=new Blob([JSON.stringify(h(h({},this.payload),t))],{type:"text/plain"});navigator.sendBeacon&&!this.sentPayload&&(navigator.sendBeacon(mt,e),this.sentPayload=!0)}}class Ut extends q{sendContext(t){const e=new Blob([JSON.stringify(h(h({},this.payload),t))],{type:"text/plain"});navigator.sendBeacon&&!this.sentPayload&&(navigator.sendBeacon(yt,e),this.sentPayload=!0)}}const Wt=n=>n.split(/(?=[A-Z])/).join("_").toLowerCase(),Nt=n=>n.split(/(?=[A-Z])/).join("-").toLowerCase();function _t(n){return Object.keys(n.dataset).filter(t=>t.indexOf("gyg")!==-1).reduce((t,e)=>{const r=Wt(Lt(e));return j(h({},t),{[r]:n.dataset[e]})},{})}function Lt(n){return n.slice(3)}function Mt(n){return n.getAttribute("data-gyg-widget")==="auto"}async function Yt(n){const t=await n.getSha(),e=window.GYG.partnerHash;return h({sha:t,href:ht},e?{partner_id:e}:{})}class Bt extends D{constructor(t){super(),this.els=t,this.start()}start(){document.readyState==="complete"?this.generateWidgets(document):window.addEventListener("DOMContentLoaded",()=>{this.generateWidgets(document)}),setInterval(()=>{document.readyState==="complete"&&this.generateWidgets(document)},1e3)}async generateWidgets(t){const e=this.scrape(t);this.els.push(...e);for(const r of e){this.markElement(r);const o=_t(r);if(Mt(r)){const a=Ht({target:r}),i=await Yt(a);this.build({el:r,attributes:h(h({},o),i)})}else Dt({target:r}),this.build({el:r,attributes:o})}}}class qt extends D{constructor(t,e,r){super(),this.els=t,this.convertOptionsToDataAttributes(e,r)}convertOptionsToDataAttributes(t,e){t.setAttribute("data-gyg-href",pt),t.setAttribute("data-gyg-widget","activities");for(const[r,o]of Object.entries(e))t.setAttribute(`data-gyg-${Nt(r)}`,o)}}const $t=.8,Ft=1.5,kt=1.2,Vt=50,jt=600,Xt=12,Kt=12,Jt=2,zt=2e3;function Zt(n,t){const e=window.getComputedStyle(n);e.maxWidth!=="none"&&(t.style.maxWidth=e.maxWidth,t.style.marginLeft="auto",t.style.marginRight="auto")}function Qt(n){if(!n)return!1;const t=[...n.children];for(const e of t)if(window.getComputedStyle(e).float!=="none")return!0;return!1}function te(n,t){const e=[...document.querySelectorAll("[data-gyg-widget]")],r=n.getBoundingClientRect();for(const o of e){const a=o.getBoundingClientRect();if(Math.abs(a.top-r.bottom)<t||Math.abs(a.bottom-r.top)<t)return!0}return!1}function ee(){const n=[...document.querySelectorAll("div > p")],[t,e]=[window.innerHeight,window.innerWidth],r=Math.min(e*$t,jt),o=n.filter(c=>{const s=c.getBoundingClientRect(),f=s.height>Vt,p=s.width>r,x=s.bottom+window.scrollY>t*Ft,m=!Qt(c.parentElement),w=!te(c,t*kt);return p&&f&&x&&m&&w});if(o.length===0)return null;let a=o[0],i=a.getBoundingClientRect().bottom;for(const c of o){const s=c.getBoundingClientRect().bottom;s<i&&(a=c,i=s)}return a}function ne(){const n=document.createElement("div");n.setAttribute("data-gyg-widget","auto"),n.style.marginTop=`${Xt}px`,n.style.marginBottom=`${Kt}px`;const t=re();t&&n.setAttribute("data-gyg-excluded-keywords",t);const e=oe();return e&&n.setAttribute("data-gyg-cmp",e),n}function re(){const n=document.querySelector("[data-gyg-global-excluded-keywords]");if(n)return n.getAttribute("data-gyg-global-excluded-keywords")}function oe(){const n=document.querySelector("[data-gyg-global-cmp]");if(n)return n.getAttribute("data-gyg-global-cmp")}function ae(){const n=document.querySelector("[data-gyg-global-auto-insert-limit]"),t=document.querySelectorAll("[data-gyg-widget]").length;let e=Jt;if(n){const r=n.getAttribute("data-gyg-global-auto-insert-limit");r&&(e=parseInt(r,10))}return e-t}function ie(){const n=ne(),t=ee();t&&(Zt(t,n),t.after(n))}function se(){const n=document.querySelector("[data-gyg-global-excluded-host-urls]");if(n){const t=n.getAttribute("data-gyg-global-excluded-host-urls");if(t){const e=window.location.pathname,r=t.split(",");for(const o of r)if(e===o.trim())return!0}}return!1}function $(){const n=!!document.querySelector("[data-gyg-global-auto-insert]"),t=document.readyState==="complete";if(n&&t&&!se()){const e=ae();for(let r=0;r<e;r++)ie()}setTimeout($,zt)}function ce(){$()}return(async()=>{if(window.GYG=window.GYG||{},Object.prototype.hasOwnProperty.call(window.GYG,"Widget"))return;window.GYG.debug=window.location.search.includes("debug=true")||!1,window.GYG.partnerHash=X(),window.GYG.els=window.GYG.els||[],Q(tt),window.GYG.Widget=async(t,e)=>{await M(window),new qt(window.GYG.els,t,e)},window.GYG.refresh=()=>{class t extends D{}new t().refreshWidgets(document)},await M(window),new Bt(window.GYG.els),At()&&J(window),ce()})()}();
